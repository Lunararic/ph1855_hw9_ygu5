---
title: "ph1855_hw9_ygu5"
author: "Yue Gu"
date: "2024-04-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(NSM3)
library(tidyverse)
```

# Hollander et al. Nonparametric Statistical Methods 2014
# P457 Q1
```{r}
X = c(0,5000,10000,15000,20000,25000,30000,100000)
Y = c(0.924,0.988,0.992,1.118,1.133,1.145,1.157,1.357)
theil(X, Y, beta.0 = 0, type = "u")

```

# P457 Q3
```{r}
Cys = c(28.9,32.8,12.0,9.9,15.0,38.0,12.5,36.5,8.6,26.8)
Worms=c(1.0,7.7,7.3,7.9,1.1,3.5,18.9,33.9,28.6,25.0)
theil(Cys, Worms, beta.0 = 0, type = "u")

```

# P460 Q7
```{r}
X = c(0,5000,10000,15000,20000,25000,30000,100000)
Y = c(0.924,0.988,0.992,1.118,1.133,1.145,1.157,1.357)
theil(X, Y, slopes = T)
# calculate the median of the slopes
median(c(1.280000e-05,
6.800000e-06,
1.293333e-05,
1.045000e-05,
8.840000e-06,
7.766667e-06,
4.330000e-06,
8.000000e-07,
1.300000e-05,
9.666667e-06,
7.850000e-06,
6.760000e-06,
3.884211e-06,
2.520000e-05,
1.410000e-05,
1.020000e-05,
8.250000e-06,
4.055556e-06,
3.000000e-06,
2.700000e-06,
2.600000e-06,
2.811765e-06,
2.400000e-06,
2.400000e-06,
2.800000e-06,
2.400000e-06,
2.826667e-06,
2.857143e-06))
```


# P460 Q13
```{r}
X = c(0,5000,10000,15000,20000,25000,30000,100000)
Y = c(0.924,0.988,0.992,1.118,1.133,1.145,1.157,1.357)
summary(lm(Y~X))

```


# P460 Q7
```{r}
X = c(0,5000,10000,15000,20000,25000,30000,100000)
Y = c(0.924,0.988,0.992,1.118,1.133,1.145,1.157,1.357)
confint(lm(Y~X), level = 0.9)

```

